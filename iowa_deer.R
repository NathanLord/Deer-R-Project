library(tidyverse)
library(ggplot2)
library(plotly) # For interactive part
library(ggrepel) # For overlapping of label/text



# https://gooutdoorsiowa.com/RealTimeHarvestReport.aspx

raw_data <- "01,Adair,512,34,462,89,10,1107,7,68
02,Adams,437,17,412,60,5,931,1,82
03,Allamakee,1805,102,1340,246,51,3544,12,433
04,Appanoose,1068,77,867,163,29,2204,15,341
05,Audubon,100,4,194,12,6,316,2,51
06,Benton,448,13,427,89,15,992,8,79
07,Black Hawk,306,17,318,66,7,714,5,116
08,Boone,544,33,558,103,12,1250,7,129
09,Bremer,436,25,436,95,3,995,13,155
10,Buchanan,425,20,392,104,6,947,4,148
11,Buena Vista,68,3,154,11,2,238,2,38
12,Butler,467,17,489,82,14,1069,5,124
13,Calhoun,25,1,115,9,1,151,0,8
14,Carroll,80,5,172,20,3,280,5,31
15,Cass,216,9,306,29,10,570,4,42
16,Cedar,511,19,472,87,6,1095,6,55
17,Cerro Gordo,221,10,276,36,6,549,5,119
18,Cherokee,203,3,273,23,4,506,3,92
19,Chickasaw,412,21,432,91,14,970,13,140
20,Clarke,926,60,649,124,16,1775,10,254
21,Clay,190,9,280,24,6,509,4,52
22,Clayton,2201,90,1469,318,59,4137,19,424
23,Clinton,487,27,549,100,9,1172,3,86
24,Crawford,105,5,235,20,1,366,0,63
25,Dallas,778,37,609,140,15,1579,6,113
26,Davis,942,75,706,190,17,1930,13,164
27,Decatur,989,44,776,103,16,1928,8,254
28,Delaware,809,54,561,135,19,1578,11,199
29,Des Moines,683,25,589,104,6,1407,0,83
30,Dickinson,106,6,183,25,6,326,7,33
31,Dubuque,1115,71,765,233,9,2193,20,234
32,Emmet,82,3,159,15,1,260,5,26
33,Fayette,1026,38,696,191,27,1978,5,280
34,Floyd,413,28,399,72,5,917,15,172
35,Franklin,200,2,262,44,6,514,3,35
36,Fremont,125,3,255,21,2,406,3,95
37,Greene,175,5,258,40,7,485,2,43
38,Grundy,43,1,99,3,1,147,0,2
39,Guthrie,1171,63,778,193,27,2232,4,216
40,Hamilton,133,4,225,24,5,391,1,25
41,Hancock,150,5,172,19,1,347,1,20
42,Hardin,386,14,411,43,11,865,1,83
43,Harrison,365,12,405,54,4,840,8,277
44,Henry,679,43,614,135,15,1486,2,81
45,Howard,355,29,272,75,7,738,9,79
46,Humboldt,69,6,163,13,3,254,1,15
47,Ida,39,2,93,10,0,144,0,17
48,Iowa,585,23,704,91,14,1417,4,117
49,Jackson,1046,57,889,225,28,2245,15,351
50,Jasper,336,14,452,68,6,876,10,153
51,Jefferson,866,41,602,158,8,1675,0,64
52,Johnson,865,45,667,142,17,1736,11,114
53,Jones,888,34,704,143,11,1780,6,226
54,Keokuk,516,21,564,76,9,1186,4,68
55,Kossuth,112,8,250,18,2,390,2,30
56,Lee,1070,54,873,171,13,2181,3,166
57,Linn,921,35,794,169,22,1941,16,212
58,Louisa,543,26,549,121,9,1248,1,68
59,Lucas,969,43,791,144,19,1966,12,260
60,Lyon,133,8,205,16,4,366,1,35
61,Madison,1630,68,1008,194,36,2936,16,254
62,Mahaska,430,19,436,82,5,972,6,117
63,Marion,899,44,809,177,21,1950,14,241
64,Marshall,239,6,303,40,7,595,3,73
65,Mills,136,7,237,23,2,405,6,75
66,Mitchell,304,17,387,51,3,762,13,124
67,Monona,307,14,338,35,3,697,1,166
68,Monroe,1206,68,779,167,37,2257,7,225
69,Montgomery,231,4,270,32,1,538,0,45
70,Muscatine,572,27,531,133,6,1269,6,93
71,Obrien,99,2,140,11,2,254,0,31
72,Osceola,41,1,85,5,2,134,0,3
73,Page,224,7,302,29,1,563,4,49
74,Palo Alto,133,2,204,17,4,360,2,15
75,Plymouth,111,8,284,23,6,432,6,150
76,Pocahontas,51,1,141,8,1,202,0,5
77,Polk,564,33,344,86,10,1037,6,120
78,Pottawattamie,279,9,380,46,5,719,13,207
79,Poweshiek,329,15,428,56,5,833,6,69
80,Ringgold,784,45,685,118,16,1648,4,129
81,Sac,114,8,222,14,3,361,0,28
82,Scott,342,21,310,50,10,733,4,22
83,Shelby,79,1,201,17,4,302,8,40
84,Sioux,84,8,170,19,1,282,3,49
85,Story,191,12,291,35,2,531,4,41
86,Tama,659,32,707,101,7,1506,7,126
87,Taylor,860,45,739,92,10,1746,4,97
88,Union,717,35,516,108,10,1386,2,122
89,Van Buren,1456,84,1083,246,29,2898,3,213
90,Wapello,722,32,548,110,22,1434,4,118
91,Warren,1124,39,1022,203,17,2405,18,341
92,Washington,897,61,713,179,12,1862,0,69
93,Wayne,1080,55,773,138,20,2066,10,258
94,Webster,360,21,496,60,8,945,7,86
95,Winnebago,106,4,175,23,4,312,6,43
96,Winneshiek,1335,99,815,214,39,2502,4,246
97,Woodbury,251,15,343,38,8,655,10,201
98,Worth,130,5,237,26,7,405,6,92
99,Wright,107,7,243,24,4,385,2,23
"

# Remove leading and trailing whitespace
raw_data <- trimws(raw_data)

# Split the raw data into lines
lines <- strsplit(raw_data, "\n")[[1]]

# Split each line into individual elements
elements <- strsplit(lines, ",")


ia_deer <- data.frame(
  County_ID = as.character(sapply(elements, `[`, 1)),
  County = as.character(sapply(elements, `[`, 2)),
  Antlerless = as.numeric(sapply(elements, `[`, 3)),
  Doe_Fawn = as.numeric(sapply(elements, `[`, 4)),
  Antlered = as.numeric(sapply(elements, `[`, 5)),
  Button_Bucks = as.numeric(sapply(elements, `[`, 6)),
  Shed_Antler_Bucks = as.numeric(sapply(elements, `[`, 7)),
  Total = as.numeric(sapply(elements, `[`, 8)),
  Fall_Turkey = as.numeric(sapply(elements, `[`, 9)),
  Spring_Turkey = as.numeric(sapply(elements, `[`, 10))
)


view(ia_deer)


ia_deer <- ia_deer |>
  mutate(Antlered = Antlered + Button_Bucks + Shed_Antler_Bucks) |>
  select(-Button_Bucks, -Shed_Antler_Bucks)

ia_deer <- ia_deer |>
  mutate(Antlerless = Antlerless + Doe_Fawn) |>
  select(-Doe_Fawn)

view(ia_deer)





01,Adair,512,34,462,89,10,1107,7,68
02,Adams,437,17,412,60,5,931,1,82
03,Allamakee,1805,102,1340,246,51,3544,12,433
04,Appanoose,1068,77,867,163,29,2204,15,341
05,Audubon,100,4,194,12,6,316,2,51
06,Benton,448,13,427,89,15,992,8,79
07,Black Hawk,306,17,318,66,7,714,5,116
08,Boone,544,33,558,103,12,1250,7,129
09,Bremer,436,25,436,95,3,995,13,155
10,Buchanan,425,20,392,104,6,947,4,148
11,Buena Vista,68,3,154,11,2,238,2,38
12,Butler,467,17,489,82,14,1069,5,124
13,Calhoun,25,1,115,9,1,151,0,8
14,Carroll,80,5,172,20,3,280,5,31
15,Cass,216,9,306,29,10,570,4,42
16,Cedar,511,19,472,87,6,1095,6,55
17,Cerro Gordo,221,10,276,36,6,549,5,119
18,Cherokee,203,3,273,23,4,506,3,92
19,Chickasaw,412,21,432,91,14,970,13,140
20,Clarke,926,60,649,124,16,1775,10,254
21,Clay,190,9,280,24,6,509,4,52
22,Clayton,2201,90,1469,318,59,4137,19,424
23,Clinton,487,27,549,100,9,1172,3,86
24,Crawford,105,5,235,20,1,366,0,63
25,Dallas,778,37,609,140,15,1579,6,113
26,Davis,942,75,706,190,17,1930,13,164
27,Decatur,989,44,776,103,16,1928,8,254
28,Delaware,809,54,561,135,19,1578,11,199
29,Des Moines,683,25,589,104,6,1407,0,83
30,Dickinson,106,6,183,25,6,326,7,33
31,Dubuque,1115,71,765,233,9,2193,20,234
32,Emmet,82,3,159,15,1,260,5,26
33,Fayette,1026,38,696,191,27,1978,5,280
34,Floyd,413,28,399,72,5,917,15,172
35,Franklin,200,2,262,44,6,514,3,35
36,Fremont,125,3,255,21,2,406,3,95
37,Greene,175,5,258,40,7,485,2,43
38,Grundy,43,1,99,3,1,147,0,2
39,Guthrie,1171,63,778,193,27,2232,4,216
40,Hamilton,133,4,225,24,5,391,1,25
41,Hancock,150,5,172,19,1,347,1,20
42,Hardin,386,14,411,43,11,865,1,83
43,Harrison,365,12,405,54,4,840,8,277
44,Henry,679,43,614,135,15,1486,2,81
45,Howard,355,29,272,75,7,738,9,79
46,Humboldt,69,6,163,13,3,254,1,15
47,Ida,39,2,93,10,0,144,0,17
48,Iowa,585,23,704,91,14,1417,4,117
49,Jackson,1046,57,889,225,28,2245,15,351
50,Jasper,336,14,452,68,6,876,10,153
51,Jefferson,866,41,602,158,8,1675,0,64
52,Johnson,865,45,667,142,17,1736,11,114
53,Jones,888,34,704,143,11,1780,6,226
54,Keokuk,516,21,564,76,9,1186,4,68
55,Kossuth,112,8,250,18,2,390,2,30
56,Lee,1070,54,873,171,13,2181,3,166
57,Linn,921,35,794,169,22,1941,16,212
58,Louisa,543,26,549,121,9,1248,1,68
59,Lucas,969,43,791,144,19,1966,12,260
60,Lyon,133,8,205,16,4,366,1,35
61,Madison,1630,68,1008,194,36,2936,16,254
62,Mahaska,430,19,436,82,5,972,6,117
63,Marion,899,44,809,177,21,1950,14,241
64,Marshall,239,6,303,40,7,595,3,73
65,Mills,136,7,237,23,2,405,6,75
66,Mitchell,304,17,387,51,3,762,13,124
67,Monona,307,14,338,35,3,697,1,166
68,Monroe,1206,68,779,167,37,2257,7,225
69,Montgomery,231,4,270,32,1,538,0,45
70,Muscatine,572,27,531,133,6,1269,6,93
